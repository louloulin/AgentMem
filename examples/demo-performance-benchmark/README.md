# AgentMem æ€§èƒ½åŸºå‡†æµ‹è¯•å·¥å…·

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ€§èƒ½åŸºå‡†æµ‹è¯•å·¥å…·ï¼Œç”¨äºæµ‹è¯•AgentMemçš„å®é™…æ€§èƒ½è¡¨ç°ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- âœ… **çœŸå®APIæµ‹è¯•**ï¼šä½¿ç”¨çœŸå®çš„Memory APIè¿›è¡Œæµ‹è¯•
- âœ… **å¤šç»´åº¦æµ‹è¯•**ï¼šæ¶µç›–æ·»åŠ ã€æœç´¢ã€åˆ é™¤ã€å¹¶å‘ç­‰å¤šç§æ“ä½œ
- âœ… **è¯¦ç»†ç»Ÿè®¡**ï¼šåŒ…æ‹¬ååé‡ã€å¹³å‡å»¶è¿Ÿã€P95/P99å»¶è¿Ÿ
- âœ… **è‡ªåŠ¨åŒ–è¯„ä¼°**ï¼šè‡ªåŠ¨è¯„ä¼°æ€§èƒ½è¡¨ç°
- âœ… **å½©è‰²è¾“å‡º**ï¼šæ˜“äºé˜…è¯»çš„æµ‹è¯•æŠ¥å‘Š

## æµ‹è¯•é¡¹ç›®

### 1. å†…å­˜æ·»åŠ æ“ä½œ
æµ‹è¯•å‘AgentMemæ·»åŠ è®°å¿†çš„æ€§èƒ½ã€‚

**æµ‹è¯•æŒ‡æ ‡**:
- æ¯ç§’æ“ä½œæ•°ï¼ˆops/sï¼‰
- å¹³å‡å»¶è¿Ÿï¼ˆmsï¼‰
- P95/P99å»¶è¿Ÿï¼ˆmsï¼‰

### 2. å†…å­˜æœç´¢æ“ä½œ
æµ‹è¯•è¯­ä¹‰æœç´¢çš„æ€§èƒ½ã€‚

**æµ‹è¯•åœºæ™¯**:
- åœ¨100æ¡è®°å¿†ä¸­æœç´¢
- å¤šç§æŸ¥è¯¢è¯æµ‹è¯•

### 3. å†…å­˜åˆ é™¤æ“ä½œ
æµ‹è¯•åˆ é™¤è®°å¿†çš„æ€§èƒ½ã€‚

**æµ‹è¯•åœºæ™¯**:
- æ‰¹é‡åˆ é™¤æ“ä½œ
- å»¶è¿Ÿç»Ÿè®¡

### 4. å¹¶å‘æ·»åŠ æ“ä½œ
æµ‹è¯•AgentMemçš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚

**æµ‹è¯•åœºæ™¯**:
- 5ä¸ªå¹¶å‘ä»»åŠ¡
- æ¯ä¸ªä»»åŠ¡æ‰§è¡Œ20æ¬¡æ“ä½œ

### 5. å¤§è§„æ¨¡æ•°æ®æœç´¢
æµ‹è¯•åœ¨å¤§é‡æ•°æ®ä¸­çš„æœç´¢æ€§èƒ½ã€‚

**æµ‹è¯•åœºæ™¯**:
- 1000æ¡è®°å¿†æ•°æ®
- å¤šç§æŸ¥è¯¢æµ‹è¯•

## è¿è¡Œæ–¹å¼

```bash
cd examples/demo-performance-benchmark
cargo run --release
```

**æ³¨æ„**ï¼šä½¿ç”¨`--release`æ¨¡å¼å¯ä»¥è·å¾—æ›´å‡†ç¡®çš„æ€§èƒ½æ•°æ®ã€‚

## ç¤ºä¾‹è¾“å‡º

```
ğŸš€ AgentMem æ€§èƒ½åŸºå‡†æµ‹è¯•å·¥å…·
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æµ‹è¯•é…ç½®:
  è¿­ä»£æ¬¡æ•°:     100
  é¢„çƒ­æ¬¡æ•°:     10
  å¹¶å‘ä»»åŠ¡æ•°:   5


â–¶ æµ‹è¯• 1/5: å†…å­˜æ·»åŠ æ“ä½œ

ğŸ“Š å†…å­˜æ·»åŠ æ“ä½œ æ€§èƒ½æŠ¥å‘Š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»æ“ä½œæ•°:     100
æ€»è€—æ—¶:       2.34s
ååé‡:       42.73 ops/s
å¹³å‡å»¶è¿Ÿ:     23.42 ms
P95 å»¶è¿Ÿ:     45.67 ms
P99 å»¶è¿Ÿ:     56.78 ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

...

ğŸ¯ æ€§èƒ½æµ‹è¯•æ€»ç»“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å†…å­˜æ·»åŠ æ“ä½œ                  |     42 ops/s |     23.4 ms |     45.7 ms
å†…å­˜æœç´¢æ“ä½œ                  |     85 ops/s |     11.8 ms |     23.4 ms
å†…å­˜åˆ é™¤æ“ä½œ                  |    123 ops/s |      8.1 ms |     16.7 ms
å¹¶å‘æ·»åŠ æ“ä½œï¼ˆ5ä¸ªä»»åŠ¡ï¼‰        |    156 ops/s |      6.4 ms |     12.3 ms
å¤§è§„æ¨¡æœç´¢ï¼ˆ1000æ¡æ•°æ®ï¼‰       |     67 ops/s |     14.9 ms |     28.9 ms
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… æ‰€æœ‰æ€§èƒ½æµ‹è¯•å®Œæˆï¼

ğŸ“ˆ æ€§èƒ½è¯„ä¼°:
  å†…å­˜æ·»åŠ æ“ä½œ - éœ€è¦ä¼˜åŒ– âš 
  å†…å­˜æœç´¢æ“ä½œ - è‰¯å¥½ âœ“
  å†…å­˜åˆ é™¤æ“ä½œ - ä¼˜ç§€ âœ¨
  å¹¶å‘æ·»åŠ æ“ä½œï¼ˆ5ä¸ªä»»åŠ¡ï¼‰ - ä¼˜ç§€ âœ¨
  å¤§è§„æ¨¡æœç´¢ï¼ˆ1000æ¡æ•°æ®ï¼‰ - è‰¯å¥½ âœ“
```

## æ€§èƒ½æŒ‡æ ‡è¯´æ˜

### ååé‡ï¼ˆops/sï¼‰
æ¯ç§’é’Ÿèƒ½å®Œæˆçš„æ“ä½œæ•°é‡ã€‚

**è¯„ä¼°æ ‡å‡†**:
- ä¼˜ç§€ âœ¨ï¼š> 100 ops/s
- è‰¯å¥½ âœ“ï¼š50-100 ops/s
- éœ€è¦ä¼˜åŒ– âš ï¼š< 50 ops/s

### å»¶è¿Ÿï¼ˆmsï¼‰
å®Œæˆå•ä¸ªæ“ä½œæ‰€éœ€çš„æ—¶é—´ã€‚

**å»¶è¿Ÿç±»å‹**:
- **å¹³å‡å»¶è¿Ÿ**ï¼šæ‰€æœ‰æ“ä½œçš„å¹³å‡æ—¶é—´
- **P95å»¶è¿Ÿ**ï¼š95%çš„æ“ä½œåœ¨è¿™ä¸ªæ—¶é—´å†…å®Œæˆ
- **P99å»¶è¿Ÿ**ï¼š99%çš„æ“ä½œåœ¨è¿™ä¸ªæ—¶é—´å†…å®Œæˆ

## é…ç½®é€‰é¡¹

å¯ä»¥é€šè¿‡ä¿®æ”¹ `BenchmarkConfig` æ¥è°ƒæ•´æµ‹è¯•å‚æ•°ï¼š

```rust
let config = BenchmarkConfig {
    iterations: 1000,       // æµ‹è¯•è¿­ä»£æ¬¡æ•°
    warmup_iterations: 10,  // é¢„çƒ­æ¬¡æ•°
    concurrent_tasks: 5,    // å¹¶å‘ä»»åŠ¡æ•°
};
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å¦‚æœæ·»åŠ æ“ä½œè¾ƒæ…¢
1. æ£€æŸ¥æ˜¯å¦å¯ç”¨äº†æ™ºèƒ½ç‰¹æ€§ï¼ˆå¦‚æœä¸éœ€è¦å¯ä»¥ç¦ç”¨ï¼‰
2. è€ƒè™‘ä½¿ç”¨æ‰¹é‡æ·»åŠ API
3. æ£€æŸ¥ç£ç›˜I/Oæ€§èƒ½

### å¦‚æœæœç´¢æ“ä½œè¾ƒæ…¢
1. ç¡®è®¤å‘é‡ç´¢å¼•å·²æ­£ç¡®æ„å»º
2. å‡å°‘æ¯æ¬¡æœç´¢è¿”å›çš„ç»“æœæ•°é‡
3. è€ƒè™‘ä½¿ç”¨ç¼“å­˜ç­–ç•¥

### å¦‚æœå¹¶å‘æ€§èƒ½ä¸ä½³
1. æ£€æŸ¥æ˜¯å¦æœ‰é”ç«äº‰
2. è€ƒè™‘å¢åŠ æ•°æ®åº“è¿æ¥æ± å¤§å°
3. ä½¿ç”¨å¼‚æ­¥æ“ä½œé¿å…é˜»å¡

## å¯¹æ¯”å‚è€ƒ

### ä¸Mem0å¯¹æ¯”ï¼ˆPythonå®ç°ï¼‰

æ ¹æ®ç†è®ºåˆ†æï¼ŒAgentMemçš„æ€§èƒ½åº”è¯¥æ˜¯Mem0çš„2-10å€ï¼š

| æ“ä½œ | AgentMem (Rust) | Mem0 (Python) | æå‡ |
|------|----------------|---------------|------|
| æ·»åŠ æ“ä½œ | ~50-100 ops/s | ~20-40 ops/s | 2.5x |
| æœç´¢æ“ä½œ | ~100-200 ops/s | ~30-60 ops/s | 3x |
| å¹¶å‘æ€§èƒ½ | é«˜ï¼ˆæ— GILé™åˆ¶ï¼‰ | ä½ï¼ˆGILé™åˆ¶ï¼‰ | 5-10x |

*æ³¨ï¼šå®é™…æ€§èƒ½å–å†³äºç¡¬ä»¶é…ç½®ã€æ•°æ®è§„æ¨¡ç­‰å› ç´ *

## æ•…éšœæ’é™¤

### ç¼–è¯‘é”™è¯¯

å¦‚æœé‡åˆ°ç¼–è¯‘é”™è¯¯ï¼Œç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š

```bash
# æ›´æ–°ä¾èµ–
cargo update

# æ¸…ç†åé‡æ–°æ„å»º
cargo clean
cargo build --release
```

### è¿è¡Œæ—¶é”™è¯¯

å¦‚æœé‡åˆ°è¿è¡Œæ—¶é”™è¯¯ï¼š

1. æ£€æŸ¥ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³
2. ç¡®è®¤æ²¡æœ‰å…¶ä»–è¿›ç¨‹å ç”¨æ•°æ®åº“æ–‡ä»¶
3. æŸ¥çœ‹æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

### æ€§èƒ½å¼‚å¸¸

å¦‚æœæ€§èƒ½ç»“æœå¼‚å¸¸ï¼š

1. ä½¿ç”¨ `--release` æ¨¡å¼è¿è¡Œ
2. å…³é—­å…¶ä»–å ç”¨èµ„æºçš„ç¨‹åº
3. å¢åŠ é¢„çƒ­è¿­ä»£æ¬¡æ•°
4. å¤šæ¬¡è¿è¡Œå–å¹³å‡å€¼

## æ‰©å±•åŠŸèƒ½

### æ·»åŠ è‡ªå®šä¹‰æµ‹è¯•

å¯ä»¥æ·»åŠ è‡ªå·±çš„æµ‹è¯•åœºæ™¯ï¼š

```rust
async fn benchmark_custom_operation(config: &BenchmarkConfig) -> Result<BenchmarkResults> {
    let memory = create_test_memory().await?;
    let mut latencies = Vec::new();
    
    let start = Instant::now();
    for i in 0..config.iterations {
        let op_start = Instant::now();
        
        // ä½ çš„è‡ªå®šä¹‰æ“ä½œ
        memory.custom_operation().await?;
        
        let op_duration = op_start.elapsed();
        latencies.push(op_duration.as_secs_f64() * 1000.0);
    }
    let total_duration = start.elapsed();
    
    Ok(BenchmarkResults::new(
        "è‡ªå®šä¹‰æ“ä½œ".to_string(),
        config.iterations,
        total_duration,
        &latencies,
    ))
}
```

### å¯¼å‡ºç»“æœ

å¯ä»¥å°†æµ‹è¯•ç»“æœå¯¼å‡ºä¸ºJSONæ ¼å¼ï¼š

```rust
use serde::{Deserialize, Serialize};
use std::fs::File;
use std::io::Write;

#[derive(Serialize)]
struct BenchmarkReport {
    timestamp: String,
    results: Vec<BenchmarkResults>,
}

// å¯¼å‡ºä¸ºJSON
let report = BenchmarkReport {
    timestamp: chrono::Utc::now().to_rfc3339(),
    results: all_results,
};

let json = serde_json::to_string_pretty(&report)?;
let mut file = File::create("benchmark_results.json")?;
file.write_all(json.as_bytes())?;
```

## ç›¸å…³æ–‡æ¡£

- [AgentMemä¸»æ–‡æ¡£](../../README.md)
- [æ€§èƒ½ä¼˜åŒ–æŒ‡å—](../../docs/PERFORMANCE.md)
- [Memory APIæ–‡æ¡£](../../crates/agent-mem/README.md)
- [æ€§èƒ½ç›‘æ§](../../crates/agent-mem-observability/README.md)

## è´¡çŒ®

å¦‚æœä½ æœ‰æ–°çš„æµ‹è¯•åœºæ™¯æƒ³æ³•æˆ–æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼Œæ¬¢è¿æäº¤PRæˆ–Issueï¼

## è®¸å¯è¯

MIT OR Apache-2.0

