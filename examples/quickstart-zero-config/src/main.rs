//! é›¶é…ç½®å¿«é€Ÿå¼€å§‹ç¤ºä¾‹
//!
//! æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ AgentMem çš„é›¶é…ç½®åˆå§‹åŒ–å’Œé»˜è®¤æ™ºèƒ½åŠŸèƒ½
//!
//! # è¿è¡Œæ–¹å¼
//!
//! ```bash
//! # è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆä»»é€‰å…¶ä¸€ï¼‰
//! export OPENAI_API_KEY=sk-...
//! # æˆ–
//! export ANTHROPIC_API_KEY=sk-...
//!
//! # è¿è¡Œç¤ºä¾‹
//! cargo run --example quickstart-zero-config
//! ```
//!
//! # åŠŸèƒ½æ¼”ç¤º
//!
//! 1. **é›¶é…ç½®åˆå§‹åŒ–**: `Memory::new()` è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå˜é‡
//! 2. **é»˜è®¤æ™ºèƒ½åŠŸèƒ½**: è‡ªåŠ¨å¯ç”¨äº‹å®æå–ã€å»é‡ã€å†²çªè§£å†³
//! 3. **æ™ºèƒ½å»é‡**: è‡ªåŠ¨æ£€æµ‹å’Œåˆå¹¶é‡å¤è®°å¿†
//! 4. **è¯­ä¹‰æœç´¢**: æ¯«ç§’çº§å‘é‡ç›¸ä¼¼åº¦æœç´¢

use agent_mem::Memory;

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    println!("ğŸš€ AgentMem é›¶é…ç½®å¿«é€Ÿå¼€å§‹ç¤ºä¾‹\n");

    // ========================================
    // æ­¥éª¤ 1: é›¶é…ç½®åˆå§‹åŒ–
    // ========================================
    println!("ğŸ“¦ æ­¥éª¤ 1: é›¶é…ç½®åˆå§‹åŒ–");
    println!("   - è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå˜é‡ï¼ˆOPENAI_API_KEY æˆ– ANTHROPIC_API_KEYï¼‰");
    println!("   - è‡ªåŠ¨åˆå§‹åŒ–å‘é‡å­˜å‚¨å’Œ LLM");
    println!("   - é»˜è®¤å¯ç”¨æ™ºèƒ½åŠŸèƒ½ï¼ˆinfer: trueï¼‰\n");

    let mem = Memory::new().await?;
    println!("âœ… åˆå§‹åŒ–æˆåŠŸï¼\n");

    // ========================================
    // æ­¥éª¤ 2: æ·»åŠ è®°å¿†ï¼ˆé»˜è®¤å¯ç”¨æ™ºèƒ½åŠŸèƒ½ï¼‰
    // ========================================
    println!("ğŸ“ æ­¥éª¤ 2: æ·»åŠ è®°å¿†ï¼ˆé»˜è®¤å¯ç”¨æ™ºèƒ½åŠŸèƒ½ï¼‰");
    println!("   - è‡ªåŠ¨äº‹å®æå–ï¼šAI è¯†åˆ«å’Œæå–å…³é”®ä¿¡æ¯");
    println!("   - æ™ºèƒ½å»é‡ï¼šè‡ªåŠ¨æ£€æµ‹å’Œåˆå¹¶é‡å¤è®°å¿†");
    println!("   - å†²çªè§£å†³ï¼šæ™ºèƒ½å¤„ç†çŸ›ç›¾ä¿¡æ¯\n");

    println!("æ·»åŠ è®°å¿† 1: 'I love pizza'");
    let result1 = mem.add("I love pizza").await?;
    println!("âœ… æ·»åŠ æˆåŠŸ: {:?}\n", result1);

    println!("æ·»åŠ è®°å¿† 2: 'I live in San Francisco'");
    let result2 = mem.add("I live in San Francisco").await?;
    println!("âœ… æ·»åŠ æˆåŠŸ: {:?}\n", result2);

    println!("æ·»åŠ è®°å¿† 3: 'My favorite food is pizza'ï¼ˆä¸è®°å¿† 1 é‡å¤ï¼‰");
    let result3 = mem.add("My favorite food is pizza").await?;
    println!("âœ… æ·»åŠ æˆåŠŸï¼ˆå¯èƒ½å»é‡ï¼‰: {:?}\n", result3);

    // ========================================
    // æ­¥éª¤ 3: æœç´¢è®°å¿†ï¼ˆè¯­ä¹‰æœç´¢ï¼‰
    // ========================================
    println!("ğŸ” æ­¥éª¤ 3: æœç´¢è®°å¿†ï¼ˆè¯­ä¹‰æœç´¢ï¼‰");
    println!("   - æ¯«ç§’çº§å‘é‡ç›¸ä¼¼åº¦æœç´¢");
    println!("   - è‡ªåŠ¨æ’åºï¼ˆæŒ‰ç›¸å…³æ€§ï¼‰\n");

    let query = "What do you know about me?";
    println!("æœç´¢æŸ¥è¯¢: '{}'", query);

    let results = mem.search(query).await?;
    println!("âœ… æœç´¢æˆåŠŸï¼Œæ‰¾åˆ° {} æ¡è®°å¿†:\n", results.len());

    for (i, result) in results.iter().enumerate() {
        println!("  {}. {} (ç›¸å…³æ€§: {:.2})", i + 1, result.content, result.score);
    }

    // ========================================
    // æ­¥éª¤ 4: è·å–æ‰€æœ‰è®°å¿†
    // ========================================
    println!("\nğŸ“š æ­¥éª¤ 4: è·å–æ‰€æœ‰è®°å¿†");

    let all_memories = mem.get_all().await?;
    println!("âœ… å…±æœ‰ {} æ¡è®°å¿†:\n", all_memories.len());

    for (i, memory) in all_memories.iter().enumerate() {
        println!("  {}. {}", i + 1, memory.content);
    }

    // ========================================
    // æ€»ç»“
    // ========================================
    println!("\nğŸ‰ é›¶é…ç½®å¿«é€Ÿå¼€å§‹ç¤ºä¾‹å®Œæˆï¼");
    println!("\nğŸ“ å…³é”®ç‰¹æ€§:");
    println!("   âœ… é›¶é…ç½®ï¼šMemory::new() è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå˜é‡");
    println!("   âœ… æ™ºèƒ½é»˜è®¤ï¼šé»˜è®¤å¯ç”¨æ™ºèƒ½åŠŸèƒ½ï¼ˆinfer: trueï¼‰");
    println!("   âœ… è‡ªåŠ¨äº‹å®æå–ï¼šAI è‡ªåŠ¨è¯†åˆ«å’Œæå–å…³é”®ä¿¡æ¯");
    println!("   âœ… æ™ºèƒ½å»é‡ï¼šè‡ªåŠ¨æ£€æµ‹å’Œåˆå¹¶é‡å¤è®°å¿†");
    println!("   âœ… å†²çªè§£å†³ï¼šæ™ºèƒ½å¤„ç†çŸ›ç›¾ä¿¡æ¯");
    println!("   âœ… è¯­ä¹‰æœç´¢ï¼šæ¯«ç§’çº§å‘é‡ç›¸ä¼¼åº¦æœç´¢");

    println!("\nğŸ’¡ æç¤º:");
    println!("   - å¦‚æœéœ€è¦ç¦ç”¨æ™ºèƒ½åŠŸèƒ½ï¼Œè¯·å‚è€ƒ quickstart-simple-mode ç¤ºä¾‹");
    println!("   - å¦‚æœéœ€è¦ä½¿ç”¨ Session ç®¡ç†ï¼Œè¯·å‚è€ƒ README.md çš„é«˜çº§ç”¨æ³•");

    Ok(())
}

