[workspace]
resolver = "2"

# Temporarily exclude examples with compilation errors (non-core functionality)
# These can be fixed later without impacting production readiness
exclude = [
    "examples/test-intelligent-integration",  # âš ï¸ ä½¿ç”¨å·²åºŸå¼ƒçš„ trait APIï¼Œéœ€è¦é‡å†™
    "examples/batch-embedding-optimization-demo",  # ç‹¬ç«‹ç¤ºä¾‹ï¼Œä¸éœ€è¦workspaceé›†æˆ
    "crates/agent-mem-plugin-sdk/examples/hello_plugin",  # Plugin example - standalone
    "crates/agent-mem-plugin-sdk/examples/memory_processor",  # Plugin example - standalone
    "crates/agent-mem-plugin-sdk/examples/code_analyzer",  # Plugin example - standalone
]

members = [
    # æ ¸å¿ƒCrates (é€æ­¥æ·»åŠ )
    "crates/agent-mem-traits",
    "crates/agent-mem-utils",
    "crates/agent-mem-config",
    "crates/agent-mem-core",
    "crates/agent-mem",  # æ–°å¢ï¼šç»Ÿä¸€ API
    "crates/agent-mem-llm",
    "crates/agent-mem-storage",
    "crates/agent-mem-embeddings",
    "crates/agent-mem-intelligence",
    # "crates/agent-mem-server",  # Temporarily disabled - has dependency issues
    "crates/agent-mem-client",
    "crates/agent-mem-performance",
    "crates/agent-mem-distributed",
    "crates/agent-mem-compat",
    "crates/agent-mem-deployment",
    "crates/agent-mem-plugin-sdk",  # Plugin SDK
    "crates/agent-mem-plugins",     # Plugin Manager
    # "crates/agent-mem-lumosai",  # Temporarily disabled - missing lumosai_core dependency
    # "crates/agent-mem-embeddings",
    # "crates/agent-mem-session",
    # "crates/agent-mem-intelligence",

    # å¤šè¯­è¨€ç»‘å®š
    "crates/agent-mem-python",  # âœ… FIXED: Upgraded pyo3-asyncio 0.21, Arc<RwLock<>> pattern
    # "bindings/agent-mem-node",
    # "bindings/agent-mem-c",

    # å·¥å…·å’Œåº”ç”¨
    "tools/agentmem-cli",
    "tools/comprehensive-stress-test",
    "tools/libsql-stress-test",  # LibSQL çœŸå®å‹æµ‹å·¥å…·
    "tools/simple-perf-test",    # Phase 1 æ€§èƒ½æµ‹è¯•å·¥å…·
    "tools/intelligent-mode-test", # Phase 2 æ™ºèƒ½æ¨¡å¼æ€§èƒ½æµ‹è¯•å·¥å…·
    "tools/phase3-parallel-test", # Phase 3 å¹¶è¡Œå­˜å‚¨æ€§èƒ½æµ‹è¯•å·¥å…·
    "tools/batch-mode-test",     # Phase 4 æ‰¹é‡æ¨¡å¼æ€§èƒ½æµ‹è¯•å·¥å…·
    # "tools/agent-mem-server",
    # "tools/agent-mem-bench",

    # ç¤ºä¾‹
    "examples/agent-from-env-demo",
    "examples/production-memory-demo",
    "examples/env-config-demo",
    "examples/importance-scoring-demo",
    "examples/vector-search-demo",
    "examples/llm-memory-analysis-demo",
    "examples/error-handling-demo",
    "examples/mcp-stdio-server",
    "examples/langgraph-integration-demo",
    "examples/user-management-demo",
    "examples/migration-demo",
    "examples/performance-demo",
    "examples/performance-optimization-demo",
    "examples/agent-lifecycle-demo",
    "examples/database-schema-demo",
    "examples/entity-relation-extraction-demo",
    "examples/system-metrics-demo",
    "examples/onnx-embedding-demo",
    "examples/mcp-resources-demo",
    "examples/mcp-prompts-demo",
    "examples/mcp-transport-demo",
    "examples/mcp-tool-discovery-demo",
    "examples/mcp-auth-demo",
    "examples/mcp-sampling-demo",
    "examples/mcp-logging-demo",
    "examples/multimodal-ai-demo",
    "examples/advanced-reasoning-demo",
    "examples/single-binary-demo",
    "examples/observability-demo",
    "examples/fastembed-demo",
    "examples/mem0-api-demo",
    "examples/quickstart-zero-config",  # P1: é›¶é…ç½®å¿«é€Ÿå¼€å§‹ç¤ºä¾‹
    "examples/quickstart-simple-mode",  # P1: ç®€å•æ¨¡å¼ç¤ºä¾‹
    "examples/test-fastembed",  # æµ‹è¯• FastEmbed åˆå§‹åŒ–
    "examples/p0-real-verification",  # P0 çœŸå®éªŒè¯

    # ç¤ºä¾‹
    "examples/demo",
    "examples/simple-demo",
    "examples/comprehensive-test",
    "examples/phase1-integration-demo",
    "examples/phase3-demo",
    "examples/phase4-demo",  # âœ… FIXED: Updated LLM factory API
    "examples/phase5-production-demo",
    "examples/phase6-optimization-demo",
    # "examples/server-demo",  # Temporarily disabled - depends on agent-mem-server
    "examples/client-demo",
    "examples/mem0-compat-demo",
    # "examples/client-server-integration-test",  # Temporarily disabled - depends on agent-mem-server
    "examples/comprehensive-verification",  # ç»¼åˆåŠŸèƒ½éªŒè¯
    "examples/intelligent-reasoning-demo",
    "examples/intelligent-memory-demo",  # âœ… FIXED: Updated to use Memory API
    "examples/graph-memory-demo",
    # "examples/test-intelligent-integration",  # âš ï¸ å·²ç§»è‡³ excludeï¼ˆä½¿ç”¨åºŸå¼ƒçš„ trait APIï¼‰
    "examples/test-cache",
    "examples/simple-memory-demo",
    "examples/simple-api-test",
    # "examples/real-agentmem-test",  # æš‚æ—¶ç¦ç”¨ï¼šä½¿ç”¨æ—§ API
    # "examples/local-embedding-demo",  # æš‚æ—¶ç¦ç”¨ï¼šä¾èµ– candle-core æœ‰ç¼–è¯‘é—®é¢˜
    # "examples/storage-backend-demo",  # æš‚æ—¶ç¦ç”¨ï¼šéœ€è¦ä¿®å¤
    "examples/litellm-demo",
    "examples/embedding-demo",
    "examples/vector-store-demo",
    "examples/multimodal-real-demo",
    "examples/storage-migration-demo",
    "examples/embedded-mode-demo",
    "examples/embedded-persistent-demo",
    "examples/advanced-search-demo",
    "examples/context-aware-demo",
    "examples/personalization-demo",
    "examples/enterprise-security-demo",
    "examples/intelligent-compression-demo",
    "examples/multi-agent-collaboration-demo",
    "examples/enterprise-monitoring-demo",
    "examples/storage-optimization-demo",
    "examples/compute-optimization-demo",
    "examples/cloud-integration-demo",
    "examples/procedural-memory-demo",
    "examples/deepseek-test",
    "examples/multimodal-demo",
    "examples/intelligence-demo",
    "examples/mem5-demo",
    "examples/enhanced-messages-demo",
    "examples/production-telemetry-demo",
    "examples/real-implementation-demo",
    "examples/llm-provider-demo",
    # "examples/api-server-demo",  # Temporarily disabled - depends on agent-mem-server
    "examples/multi-tenant-demo",
    "examples/cloud-native-demo",
    "examples/performance-benchmark",
    # "examples/intelligent-memory-demo",  # Temporarily excluded - MemoryManager import error, API changes
    "crates/agent-mem-tools",
    "crates/agent-mem-observability", "examples/system-prompt-demo", "examples/chat-demo",
    # "examples/basic-usage",
    # "examples/advanced-features",
    # "examples/migration-from-agentmen",
    # "examples/mem0-compatibility",

# æ–°çš„çœŸå®æ¼”ç¤ºç¤ºä¾‹ï¼ˆ2025-10-24ï¼‰
    "examples/demo-memory-api",           # Memory APIåŸºç¡€æ¼”ç¤º
    "examples/demo-multimodal",           # å¤šæ¨¡æ€å¤„ç†æ¼”ç¤º
    "examples/demo-intelligent-chat",     # æ™ºèƒ½å¯¹è¯æ¼”ç¤º
    "examples/demo-performance-benchmark", # æ€§èƒ½åŸºå‡†æµ‹è¯•å·¥å…·
    "examples/demo-codebase-memory",      # ä»£ç åº“è®°å¿†ä¸æœç´¢æ¼”ç¤ºï¼ˆéœ€FastEmbedï¼‰
    "examples/demo-performance-simple",    # ç®€åŒ–æ€§èƒ½æµ‹è¯•ï¼ˆæ— Embedderä¾èµ–ï¼‰
    "examples/demo-memory-viewer",        # è®°å¿†å¯è§†åŒ–å·¥å…·ï¼ˆå¯¹æ ‡MIRIXï¼‰
    "examples/demo-performance-comparison", # æ€§èƒ½å¯¹æ¯”æµ‹è¯•ï¼ˆå¯¹æ ‡MIRIXï¼‰
    "examples/enhanced-hybrid-search-demo", # å¢å¼ºæ··åˆæœç´¢æ¼”ç¤º
    "examples/product-search-demo",        # å•†å“æœç´¢æ¼”ç¤º
    # "examples/hybrid-search-server-demo",  # Temporarily disabled - server dependency
]

# Workspace package configuration
[workspace.package]
version = "2.0.0"
edition = "2021"
authors = ["AgentMem Team <team@agentmem.dev>"]
license = "MIT OR Apache-2.0"
repository = "https://github.com/louloulin/agentmem"
homepage = "https://agentmem.dev"
documentation = "https://docs.rs/agent-mem"
keywords = ["ai", "memory", "agent", "llm", "vector"]
categories = ["database", "science", "web-programming"]

# âš¡ ç¼–è¯‘æ—¶é—´ä¼˜åŒ–é…ç½®
[profile.release]
# ä¼˜åŒ–çº§åˆ«ï¼š3 = æœ€é«˜ä¼˜åŒ–
opt-level = 3
# é“¾æ¥æ—¶ä¼˜åŒ–ï¼šthin = å¹³è¡¡æ€§èƒ½å’Œç¼–è¯‘æ—¶é—´
lto = "thin"
# ä»£ç ç”Ÿæˆå•å…ƒï¼š1 = æœ€æ…¢ç¼–è¯‘ä½†æœ€å¥½æ€§èƒ½ï¼ˆå¯ä»¥æ”¹ä¸º 16 åŠ å¿«ç¼–è¯‘ï¼‰
codegen-units = 16
# å¢é‡ç¼–è¯‘
incremental = true
# è°ƒè¯•ä¿¡æ¯ï¼š1 = è¡Œå·è¡¨ï¼ˆè¶³å¤Ÿç”¨äºbacktraceï¼Œä½†ç¼–è¯‘æ›´å¿«ï¼‰
debug = 1
# Strip ç¬¦å·ï¼šå‡å°äºŒè¿›åˆ¶å¤§å°
strip = "debuginfo"

[profile.dev]
# å¼€å‘æ¨¡å¼ä¼˜åŒ–ï¼š0 = æ— ä¼˜åŒ–ï¼ˆæœ€å¿«ç¼–è¯‘ï¼‰
opt-level = 0
# å¼€å‘æ¨¡å¼ä¸ä½¿ç”¨ LTOï¼ˆåŠ å¿«ç¼–è¯‘ï¼‰
lto = false
# æ›´å¤šä»£ç ç”Ÿæˆå•å…ƒï¼ˆåŠ å¿«å¢é‡ç¼–è¯‘ï¼‰
codegen-units = 256
# å¢é‡ç¼–è¯‘
incremental = true
# ä¿ç•™å®Œæ•´è°ƒè¯•ä¿¡æ¯
debug = 2

[profile.dev.package."*"]
# ä¾èµ–é¡¹ä½¿ç”¨ä¸€äº›ä¼˜åŒ–ï¼ˆä¸èŠ±å¤ªå¤šæ—¶é—´ç¼–è¯‘ä¾èµ–ï¼‰
opt-level = 1

# âš¡ æµ‹è¯•é…ç½®ä¼˜åŒ–
[profile.test]
opt-level = 1
debug = 2
codegen-units = 16
lto = false
incremental = true

# âš¡ Bench é…ç½®ä¼˜åŒ–
[profile.bench]
opt-level = 3
debug = 1
codegen-units = 1
lto = "thin"
incremental = false

# ğŸ“¦ ä¾èµ–ä¼˜åŒ–
[workspace.dependencies]
# å›ºå®šç‰ˆæœ¬ä»¥é¿å…é‡å¤è§£æ
tokio = { version = "1.35", features = ["full"] }
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }
uuid = { version = "1.6", features = ["v4", "serde"] }
chrono = { version = "0.4", features = ["serde"] }
anyhow = "1.0"
thiserror = "1.0"
async-trait = "0.1"
futures = "0.3"
sqlx = { version = "0.7", features = ["runtime-tokio-rustls", "sqlite"] }
sha2 = "0.10"
hex = "0.4"
tempfile = "3.8"
criterion = { version = "0.5", features = ["async_tokio", "html_reports"] }
toml = "0.8"
config = "0.14"
num_cpus = "1.16"
rand = "0.8"
dashmap = "5.5"
reqwest = { version = "0.11", features = ["json"] }
hyper = { version = "0.14", features = ["full"] }
tower = "0.4"
axum = "0.7"
bytes = "1.5"
parking_lot = "0.12"
crossbeam = "0.8"
once_cell = "1.19"
