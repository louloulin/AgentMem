# ğŸš€ AgentMem æœªæ¥æ¶æ„æ„¿æ™¯

**æ—¥æœŸ**: 2025-12-10  
**åŸºäº**: 2025æœ€æ–°ç ”ç©¶ + Unixå“²å­¦ + ContextFSè®ºæ–‡ + ç°çŠ¶åˆ†æ  
**ç›®æ ‡**: è®¾è®¡å®Œæ•´çš„æœªæ¥æ¶æ„ï¼Œèåˆæœ€ä½³å®è·µ

> ğŸ† **å½“å‰æ¶æ„å†³ç­–**: å‚è§ `FINAL_ARCHITECTURE_DECISION.md` â­â­â­  
> ğŸ“„ **ContextFSè®ºæ–‡**: `pdf/2512.05470v1.pdf` - "Everything is Context: Agentic File System Abstraction"

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

### æ ¸å¿ƒæ„¿æ™¯

**AgentMemæœªæ¥æ¶æ„** = **ç»Ÿä¸€å­˜å‚¨åè°ƒå±‚** + **ENGRAMè½»é‡çº§è®¾è®¡** + **Unixæ–‡ä»¶ç³»ç»ŸæŠ½è±¡** + **ContextFSæ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†**

### å…³é”®åˆ›æ–°ç‚¹

1. **Everything is Context** - åŸºäºContextFSè®ºæ–‡ï¼Œå°†è®°å¿†ç³»ç»ŸæŠ½è±¡ä¸ºä¸Šä¸‹æ–‡æ–‡ä»¶ç³»ç»Ÿ
2. **Everything is File** - åŸºäºUnixå“²å­¦ï¼Œæ‰€æœ‰èµ„æºé€šè¿‡æ–‡ä»¶ç³»ç»Ÿè®¿é—®
3. **Repositoryä¼˜å…ˆ** - ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢å’Œäº‹åŠ¡
4. **ç±»å‹åŒ–è®°å¿†** - å‚è€ƒENGRAMï¼Œä¸‰ç§è®°å¿†ç±»å‹ï¼ˆEpisodicã€Semanticã€Proceduralï¼‰
5. **è½»é‡çº§ç¼–æ’** - å•ä¸€è·¯ç”±å™¨+æ£€ç´¢å™¨ï¼Œé¿å…è¿‡åº¦è®¾è®¡

---

## ğŸ”¬ æœ€æ–°ç ”ç©¶æ•´åˆï¼ˆ2025å®Œæ•´ç‰ˆï¼‰

### 1. ContextFS (2025-12) â­â­â­ **æœ€æ–°åˆ›æ–°**

**è®ºæ–‡**: "Everything is Context: Agentic File System Abstraction for Context Engineering" (arXiv:2512.05470)

**æ ¸å¿ƒæ€æƒ³**:
- **Everything is Context** - ä¸€åˆ‡éƒ½æ˜¯ä¸Šä¸‹æ–‡
- å°†æ–‡ä»¶ç³»ç»Ÿé‡æ–°æŠ½è±¡ä¸ºä¸Šä¸‹æ–‡ç®¡ç†ç³»ç»Ÿ
- æ™ºèƒ½ä»£ç†å’Œè¯­ä¹‰ç†è§£æŠ€æœ¯
- ç»Ÿä¸€çš„ä¸Šä¸‹æ–‡è®¿é—®æ¥å£

**å…³é”®è®¾è®¡**:
```
ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿ â†’ ä¸Šä¸‹æ–‡æ–‡ä»¶ç³»ç»Ÿ
â”œâ”€â”€ æ–‡ä»¶ â†’ ä¸Šä¸‹æ–‡å•å…ƒ
â”œâ”€â”€ ç›®å½• â†’ ä¸Šä¸‹æ–‡å‘½åç©ºé—´
â”œâ”€â”€ è·¯å¾„ â†’ ä¸Šä¸‹æ–‡è·¯å¾„
â””â”€â”€ æ“ä½œ â†’ ä¸Šä¸‹æ–‡æ“ä½œï¼ˆread_context, write_context, search_contextï¼‰
```

**åº”ç”¨åœºæ™¯**:
- è®°å¿†ç³»ç»Ÿå¯ä»¥ä½œä¸ºä¸Šä¸‹æ–‡æ–‡ä»¶ç³»ç»Ÿå®ç°
- `/context/memories/{agent_id}/{memory_id}` - è®°å¿†ä½œä¸ºä¸Šä¸‹æ–‡æ–‡ä»¶
- `/context/knowledge/{domain}/{entity}` - çŸ¥è¯†ä½œä¸ºä¸Šä¸‹æ–‡ç›®å½•
- `/context/sessions/{session_id}/` - ä¼šè¯ä½œä¸ºä¸Šä¸‹æ–‡å‘½åç©ºé—´

---

### 2. ENGRAM (2025-11) â­â­â­ **SOTAæ€§èƒ½**

**æ ¸å¿ƒè®¾è®¡**:
- LoCoMoåŸºå‡†æµ‹è¯•SOTA
- ä½¿ç”¨1%çš„tokenè¾¾åˆ°å…¨ä¸Šä¸‹æ–‡åŸºçº¿+15åˆ†
- ä¸‰ç§è®°å¿†ç±»å‹ï¼ˆEpisodicã€Semanticã€Proceduralï¼‰
- è½»é‡çº§æ¶æ„ï¼Œé¿å…å¤æ‚è®¾è®¡

**å…³é”®æ´å¯Ÿ**: ç®€å•æ¶æ„å¯ä»¥è¶…è¶Šå¤æ‚ç³»ç»Ÿ

---

### 3. A-MemGuard (2025-10) â­â­ **å®‰å…¨æ¡†æ¶**

**æ ¸å¿ƒè®¾è®¡**:
- ä¸»åŠ¨é˜²å¾¡æ¡†æ¶
- å…±è¯†éªŒè¯ + åŒè®°å¿†ç»“æ„
- æ”»å‡»æˆåŠŸç‡é™ä½95%+
- æœ€å°å·¥å…·æˆæœ¬

---

### 4. Intrinsic Memory Agents (2025-08) â­â­ **å¤šæ™ºèƒ½ä½“**

**æ ¸å¿ƒè®¾è®¡**:
- å¼‚æ„å¤šæ™ºèƒ½ä½“LLMç³»ç»Ÿ
- ç»“æ„åŒ–ã€æ™ºèƒ½ä½“ç‰¹å®šè®°å¿†
- PDDLæ•°æ®é›†38.6%æ”¹è¿›
- æ›´é«˜tokenæ•ˆç‡

---

### 5. Structured Cognitive Loop (2025-11) â­â­ **è®¤çŸ¥å¾ªç¯**

**æ ¸å¿ƒè®¾è®¡**:
- R-CCAMæ¶æ„ï¼ˆRetrieval, Cognition, Control, Action, Memoryï¼‰
- Soft Symbolic Control
- é›¶ç­–ç•¥è¿è§„
- å®Œæ•´å†³ç­–å¯è¿½æº¯æ€§

---

### 6. MIRIX (2025-07) â­â­ **å¤šæ™ºèƒ½ä½“è®°å¿†**

**æ ¸å¿ƒè®¾è®¡**:
- 6ç§è®°å¿†ç±»å‹ï¼ˆCoreã€Episodicã€Semanticã€Proceduralã€Resourceã€Knowledge Vaultï¼‰
- ScreenshotVQA: 35%å‡†ç¡®ç‡æå‡ï¼Œ99.9%å­˜å‚¨å‡å°‘
- LOCOMO: 85.4% SOTAæ€§èƒ½

---

### 7. MemVerse (2025-12) â­â­ **å¤šæ¨¡æ€è®°å¿†**

**æ ¸å¿ƒè®¾è®¡**:
- å¤šæ¨¡æ€è®°å¿†
- å±‚æ¬¡åŒ–çŸ¥è¯†å›¾
- å‘¨æœŸæ€§è’¸é¦
- è‡ªé€‚åº”é—å¿˜

---

### 8. Collaborative Memory (2025-05) â­â­ **å¤šç”¨æˆ·å…±äº«**

**æ ¸å¿ƒè®¾è®¡**:
- å¤šç”¨æˆ·è®°å¿†å…±äº«
- åŠ¨æ€è®¿é—®æ§åˆ¶
- åŒåˆ†å›¾æƒé™æ¨¡å‹
- ä¸¤å±‚è®°å¿†ç³»ç»Ÿï¼ˆç§æœ‰+å…±äº«ï¼‰

---

## ğŸ¯ æœªæ¥æ¶æ„è®¾è®¡ï¼ˆå®Œæ•´ç‰ˆï¼‰

### æ¶æ„å±‚æ¬¡å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Application Layer (åº”ç”¨å±‚)                        â”‚
â”‚  - REST API / MCP Server / Python SDK / CLI / Web UI                â”‚
â”‚  - ContextFS Interface (/context/*)                                 â”‚
â”‚  - Unix File System Interface (/sys/agentmem/*)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Context Management Layer (ä¸Šä¸‹æ–‡ç®¡ç†å±‚)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ContextFS Abstraction                                       â”‚  â”‚
â”‚  â”‚  - /context/memories/{agent_id}/{memory_id}                  â”‚  â”‚
â”‚  â”‚  - /context/knowledge/{domain}/{entity}                      â”‚  â”‚
â”‚  â”‚  - /context/sessions/{session_id}/                           â”‚  â”‚
â”‚  â”‚  - /context/search?query=...                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Unix File System Interface                                  â”‚  â”‚
â”‚  â”‚  - /sys/agentmem/config/     (é…ç½®)                          â”‚  â”‚
â”‚  â”‚  - /sys/agentmem/status/     (çŠ¶æ€)                          â”‚  â”‚
â”‚  â”‚  - /sys/agentmem/metrics/    (æŒ‡æ ‡)                          â”‚  â”‚
â”‚  â”‚  - /sys/agentmem/memories/   (è®°å¿†)                          â”‚  â”‚
â”‚  â”‚  - /sys/agentmem/control/    (æ§åˆ¶)                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Memory Orchestrator (è®°å¿†ç¼–æ’å±‚)                             â”‚
â”‚  - add_memory() / get_all() / search() / update() / delete()        â”‚
â”‚  - Type-aware routing (Episodic/Semantic/Procedural)               â”‚
â”‚  - Lightweight orchestration (single router + retriever)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Unified Storage Coordinator (ç»Ÿä¸€å­˜å‚¨åè°ƒå±‚)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Write Strategy: Repository-First + Compensation              â”‚  â”‚
â”‚  â”‚  Read Strategy: Repository-First + VectorStore Fallback        â”‚  â”‚
â”‚  â”‚  Consistency: Verify + Sync                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“                    â†“                    â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Repository  â”‚    â”‚ VectorStore  â”‚    â”‚ HistoryMgr  â”‚    â”‚ CoreMemory   â”‚
â”‚  (LibSQL/PG) â”‚    â”‚ (LanceDB)    â”‚    â”‚ (SQLite)    â”‚    â”‚ (In-Memory)  â”‚
â”‚  âœ… Primary  â”‚    â”‚ âœ… Secondary â”‚    â”‚ âœ… Audit    â”‚    â”‚ âœ… Working   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ContextFSé›†æˆè®¾è®¡

### æ ¸å¿ƒæ¦‚å¿µ

**ContextFS** = å°†è®°å¿†ç³»ç»ŸæŠ½è±¡ä¸ºä¸Šä¸‹æ–‡æ–‡ä»¶ç³»ç»Ÿ

### æ–‡ä»¶ç³»ç»Ÿç»“æ„

```
/context/
â”œâ”€â”€ memories/                    # è®°å¿†ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ {agent_id}/
â”‚   â”‚   â”œâ”€â”€ {memory_id}          # å•ä¸ªè®°å¿†ï¼ˆJSONæ ¼å¼ï¼‰
â”‚   â”‚   â”œâ”€â”€ episodic/            # ç»éªŒè®°å¿†
â”‚   â”‚   â”œâ”€â”€ semantic/            # è¯­ä¹‰è®°å¿†
â”‚   â”‚   â””â”€â”€ procedural/          # ç¨‹åºè®°å¿†
â”‚   â””â”€â”€ ...
â”œâ”€â”€ knowledge/                    # çŸ¥è¯†ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ {domain}/
â”‚   â”‚   â”œâ”€â”€ {entity}              # å®ä½“çŸ¥è¯†
â”‚   â”‚   â””â”€â”€ {relation}            # å…³ç³»çŸ¥è¯†
â”‚   â””â”€â”€ ...
â”œâ”€â”€ sessions/                     # ä¼šè¯ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ {session_id}/
â”‚   â”‚   â”œâ”€â”€ history               # ä¼šè¯å†å²
â”‚   â”‚   â”œâ”€â”€ context               # ä¼šè¯ä¸Šä¸‹æ–‡
â”‚   â”‚   â””â”€â”€ state                 # ä¼šè¯çŠ¶æ€
â”‚   â””â”€â”€ ...
â””â”€â”€ search/                       # æœç´¢ä¸Šä¸‹æ–‡
    â””â”€â”€ ?query=...&type=...       # è¯­ä¹‰æœç´¢
```

### æ“ä½œæ¥å£

```rust
// ContextFS Trait
pub trait ContextFileSystem {
    // è¯»å–ä¸Šä¸‹æ–‡
    async fn read_context(&self, path: &str) -> Result<Context>;
    
    // å†™å…¥ä¸Šä¸‹æ–‡
    async fn write_context(&self, path: &str, context: &Context) -> Result<()>;
    
    // æœç´¢ä¸Šä¸‹æ–‡
    async fn search_context(&self, query: &str, filters: &[Filter]) -> Result<Vec<Context>>;
    
    // åˆ—å‡ºä¸Šä¸‹æ–‡
    async fn list_context(&self, path: &str) -> Result<Vec<ContextPath>>;
    
    // åˆ é™¤ä¸Šä¸‹æ–‡
    async fn delete_context(&self, path: &str) -> Result<()>;
}
```

### ä½¿ç”¨ç¤ºä¾‹

```bash
# è¯»å–è®°å¿†
cat /context/memories/agent-123/memory-456

# å†™å…¥è®°å¿†
echo '{"content":"...","type":"episodic"}' > /context/memories/agent-123/memory-789

# æœç´¢è®°å¿†
ls /context/search?query="user preference"&type=semantic

# åˆ—å‡ºæ‰€æœ‰è®°å¿†
ls -R /context/memories/agent-123/
```

---

## ğŸ§ Unixæ–‡ä»¶ç³»ç»Ÿæ¥å£è®¾è®¡

### æ–‡ä»¶ç³»ç»Ÿç»“æ„

```
/sys/agentmem/
â”œâ”€â”€ config/                      # é…ç½®ï¼ˆè¯»å†™ï¼‰
â”‚   â”œâ”€â”€ database_url
â”‚   â”œâ”€â”€ embedder_provider
â”‚   â”œâ”€â”€ embedder_model
â”‚   â”œâ”€â”€ vector_store_url
â”‚   â””â”€â”€ ...
â”œâ”€â”€ status/                       # çŠ¶æ€ï¼ˆåªè¯»ï¼‰
â”‚   â”œâ”€â”€ health                    # {"status":"healthy","uptime":3600}
â”‚   â”œâ”€â”€ version                   # {"version":"2.0.0","build":"..."}
â”‚   â”œâ”€â”€ connections               # {"active":10,"idle":5,"max":20}
â”‚   â”œâ”€â”€ memory_stats              # {"total":1000,"episodic":500,...}
â”‚   â””â”€â”€ ...
â”œâ”€â”€ metrics/                       # æŒ‡æ ‡ï¼ˆåªè¯»ï¼‰
â”‚   â”œâ”€â”€ requests_per_second
â”‚   â”œâ”€â”€ latency_p50
â”‚   â”œâ”€â”€ latency_p95
â”‚   â”œâ”€â”€ latency_p99
â”‚   â”œâ”€â”€ error_rate
â”‚   â”œâ”€â”€ cache_hit_rate
â”‚   â””â”€â”€ ...
â”œâ”€â”€ memories/                      # è®°å¿†æ•°æ®ï¼ˆåªè¯»ï¼‰
â”‚   â”œâ”€â”€ {agent_id}/
â”‚   â”‚   â”œâ”€â”€ {memory_id}           # JSONæ ¼å¼è®°å¿†æ•°æ®
â”‚   â”‚   â”œâ”€â”€ count                  # è®°å¿†æ•°é‡
â”‚   â”‚   â””â”€â”€ latest                 # æœ€æ–°è®°å¿†
â”‚   â””â”€â”€ ...
â””â”€â”€ control/                       # æ§åˆ¶æ¥å£ï¼ˆå†™æ“ä½œï¼‰
    â”œâ”€â”€ reload_config              # echo "1" > /sys/agentmem/control/reload_config
    â”œâ”€â”€ flush_cache                # echo "1" > /sys/agentmem/control/flush_cache
    â”œâ”€â”€ sync_storage               # echo "1" > /sys/agentmem/control/sync_storage
    â””â”€â”€ verify_consistency         # echo "1" > /sys/agentmem/control/verify_consistency
```

### ä½¿ç”¨ç¤ºä¾‹

```bash
# è¯»å–é…ç½®
cat /sys/agentmem/config/database_url

# å†™å…¥é…ç½®
echo "postgresql://localhost/agentmem" > /sys/agentmem/config/database_url

# è¯»å–çŠ¶æ€
cat /sys/agentmem/status/health
watch cat /sys/agentmem/status/memory_stats

# è¯»å–æŒ‡æ ‡
cat /sys/agentmem/metrics/requests_per_second
cat /sys/agentmem/metrics/latency_p95

# è¯»å–è®°å¿†
cat /sys/agentmem/memories/agent-123/memory-456

# æ§åˆ¶æ“ä½œ
echo "1" > /sys/agentmem/control/reload_config
echo "1" > /sys/agentmem/control/flush_cache
```

---

## ğŸ”„ å®Œæ•´æ•°æ®æµè®¾è®¡

### å†™å…¥æµç¨‹ï¼ˆContextFS + Repositoryä¼˜å…ˆï¼‰

```
User Request
    â†“
ContextFS.write_context("/context/memories/agent-123/memory-456", context)
    â†“
Memory Orchestrator.add_memory()
    â†“
Unified Storage Coordinator
    â”œâ”€ Step 1: Write to Repository (LibSQL) - PRIMARY
    â”‚   â””â”€ If FAIL â†’ Return Error
    â”‚
    â”œâ”€ Step 2: Write to VectorStore (LanceDB) - SECONDARY
    â”‚   â””â”€ If FAIL â†’ Rollback Repository
    â”‚
    â””â”€ Step 3: Parallel Non-Critical Tasks
        â”œâ”€ CoreMemoryManager (optional)
        â””â”€ HistoryManager (audit log)
    â†“
Update Unix FS Interface
    â”œâ”€ /sys/agentmem/memories/agent-123/memory-456
    â””â”€ /sys/agentmem/status/memory_stats
    â†“
Success Response
```

### è¯»å–æµç¨‹ï¼ˆContextFS + Repositoryä¼˜å…ˆ + Fallbackï¼‰

```
User Request
    â†“
ContextFS.read_context("/context/memories/agent-123/memory-456")
    OR
cat /sys/agentmem/memories/agent-123/memory-456
    â†“
Memory Orchestrator.get_memory()
    â†“
Unified Storage Coordinator
    â”œâ”€ Step 1: Query Repository (LibSQL) - PRIMARY
    â”‚   â””â”€ If Found â†’ Return Results
    â”‚
    â””â”€ Step 2: Check VectorStore (LanceDB) - FALLBACK
        â””â”€ If Found â†’ Sync to Repository (repair)
    â†“
Return Results (via ContextFS or Unix FS)
```

### æœç´¢æµç¨‹ï¼ˆæ··åˆæ£€ç´¢ + ContextFSï¼‰

```
User Request
    â†“
ContextFS.search_context("/context/search?query=...&type=semantic")
    â†“
Memory Orchestrator.search_memories()
    â†“
Generate Query Embedding
    â†“
Parallel Retrieval (tokio::join!)
    â”œâ”€ Temporal Search (Repository)
    â”‚   â””â”€ Recent N memories
    â”‚
    â””â”€ Semantic Search (VectorStore)
        â””â”€ Top-K similar memories
    â†“
Merge & Deduplicate (Set Union)
    â†“
Re-rank (Optional)
    â†“
Return Top-K Results (via ContextFS)
```

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### Phase 0: æ•°æ®ä¸€è‡´æ€§ä¿®å¤ï¼ˆP0 - ä»Šå¤©ï¼Œ4-6å°æ—¶ï¼‰

1. **ä¿®å¤ `add_memory_fast()` å¹¶è¡Œå†™å…¥é£é™©**
2. **ä¿®å¤ `coordinator.add_memory()` è¡¥å¿æœºåˆ¶**
3. **å®ç°æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥**

### Phase 1: æ ¸å¿ƒæ¶æ„ä¼˜åŒ–ï¼ˆP1 - ä¸‹å‘¨ï¼Œ1-2å‘¨ï¼‰

1. **å®ç°ç±»å‹åŒ–è®°å¿†**ï¼ˆEpisodicã€Semanticã€Proceduralï¼‰
2. **å®ç°è½»é‡çº§ç¼–æ’**ï¼ˆå•ä¸€è·¯ç”±å™¨+æ£€ç´¢å™¨ï¼‰
3. **å®ç°æ··åˆæ£€ç´¢**ï¼ˆæ—¶é—´+è¯­ä¹‰ï¼‰

### Phase 2: Unixæ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼ˆP1 - 2å‘¨ï¼‰

1. **å®ç°è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ**ï¼ˆFUSEæˆ–å‘½åç®¡é“ï¼‰
2. **å®ç° `/sys/agentmem/` æ¥å£**
3. **å®ç°æ–‡ä»¶ç³»ç»Ÿç›‘å¬**ï¼ˆinotify/FSEventsï¼‰

### Phase 3: ContextFSé›†æˆï¼ˆP2 - 3-4å‘¨ï¼‰

1. **å®ç°ContextFSæŠ½è±¡å±‚**
2. **å®ç° `/context/` æ–‡ä»¶ç³»ç»Ÿæ¥å£**
3. **å®ç°ä¸Šä¸‹æ–‡æœç´¢å’Œæ“ä½œ**

### Phase 4: å®‰å…¨å¢å¼ºï¼ˆP1 - 1-2å‘¨ï¼‰

1. **é›†æˆA-MemGuardå®‰å…¨æ¡†æ¶**
2. **å®ç°å…±è¯†éªŒè¯**
3. **å®ç°åŒè®°å¿†ç»“æ„**

### Phase 5: å¤šæ™ºèƒ½ä½“æ”¯æŒï¼ˆP2 - 2-3å‘¨ï¼‰

1. **é›†æˆIntrinsic Memory Agents**
2. **å®ç°æ™ºèƒ½ä½“ç‰¹å®šè®°å¿†**
3. **å®ç°è®°å¿†å…±äº«æœºåˆ¶**

---

## ğŸ“Š æ¶æ„å¯¹æ¯”ï¼ˆå®Œæ•´ç‰ˆï¼‰

| ç»´åº¦ | å½“å‰æ¶æ„ | ContextFS | Unix FS | **æœªæ¥æ¶æ„** |
|------|---------|-----------|---------|------------|
| **æ•°æ®ä¸€è‡´æ€§** | âš ï¸ æœ‰é—®é¢˜ | âœ… ç»Ÿä¸€æ¥å£ | âœ… æ–‡ä»¶ç³»ç»Ÿ | âœ… Repositoryä¼˜å…ˆ+è¡¥å¿ |
| **è®¿é—®æ¥å£** | âŒ REST API | âœ… æ–‡ä»¶ç³»ç»Ÿ | âœ… æ–‡ä»¶ç³»ç»Ÿ | âœ… ContextFS + Unix FS |
| **å¯ç»„åˆæ€§** | âš ï¸ éƒ¨åˆ† | âœ… å®Œæ•´ | âœ… å®Œæ•´ | âœ… å®Œæ•´ |
| **è¿ç»´å‹å¥½** | âš ï¸ ä¸­ç­‰ | âœ… ä¼˜ç§€ | âœ…âœ… **æä¼˜** | âœ…âœ… **æä¼˜** |
| **ç±»å‹åŒ–è®°å¿†** | âŒ æ—  | âš ï¸ éƒ¨åˆ† | âŒ æ—  | âœ… ENGRAMä¸‰ç§ç±»å‹ |
| **è½»é‡çº§** | âš ï¸ ä¸­ç­‰ | âœ… è½»é‡ | âœ… è½»é‡ | âœ… è½»é‡çº§ç¼–æ’ |
| **å®‰å…¨æ¡†æ¶** | âš ï¸ åŸºç¡€ | âŒ æ—  | âŒ æ—  | âœ… A-MemGuardé›†æˆ |
| **å¤šæ™ºèƒ½ä½“** | âŒ æ—  | âš ï¸ éƒ¨åˆ† | âŒ æ—  | âœ… Intrinsic Memory |

---

## âœ… æœ€ç»ˆæ„¿æ™¯

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **Everything is Context** - åŸºäºContextFSï¼Œæ‰€æœ‰è®°å¿†éƒ½æ˜¯ä¸Šä¸‹æ–‡
2. **Everything is File** - åŸºäºUnixå“²å­¦ï¼Œæ‰€æœ‰èµ„æºé€šè¿‡æ–‡ä»¶ç³»ç»Ÿè®¿é—®
3. **Repositoryä¼˜å…ˆ** - ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢å’Œäº‹åŠ¡
4. **ç±»å‹åŒ–è®°å¿†** - å‚è€ƒENGRAMï¼Œä¸‰ç§è®°å¿†ç±»å‹
5. **è½»é‡çº§ç¼–æ’** - å•ä¸€è·¯ç”±å™¨+æ£€ç´¢å™¨ï¼Œé¿å…è¿‡åº¦è®¾è®¡
6. **å®‰å…¨ç¬¬ä¸€** - é›†æˆA-MemGuardï¼Œä¸»åŠ¨é˜²å¾¡
7. **å¤šæ™ºèƒ½ä½“æ”¯æŒ** - é›†æˆIntrinsic Memoryï¼Œæ™ºèƒ½ä½“ç‰¹å®šè®°å¿†

### å…³é”®ä¼˜åŠ¿

1. **ç»Ÿä¸€æ¥å£** â­â­â­â­â­
   - ContextFS: `/context/*` - ä¸Šä¸‹æ–‡æ–‡ä»¶ç³»ç»Ÿ
   - Unix FS: `/sys/agentmem/*` - ç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿ
   - REST API: `/api/v1/*` - HTTPæ¥å£
   - æ‰€æœ‰æ¥å£ç»Ÿä¸€ï¼Œæ˜“äºä½¿ç”¨

2. **è¿ç»´å‹å¥½** â­â­â­â­â­
   - é…ç½®ã€çŠ¶æ€ã€æŒ‡æ ‡é€šè¿‡æ–‡ä»¶ç³»ç»Ÿè®¿é—®
   - ä¸ç°æœ‰ç›‘æ§å·¥å…·é›†æˆï¼ˆPrometheusã€Grafanaï¼‰
   - æ”¯æŒè„šæœ¬è‡ªåŠ¨åŒ–ï¼ˆbashã€zshã€fishï¼‰

3. **å¯ç»„åˆæ€§** â­â­â­â­â­
   - å‘½ä»¤å¯ä»¥ç»„åˆä½¿ç”¨ï¼ˆç®¡é“ã€è¿‡æ»¤å™¨ã€è½¬æ¢å™¨ï¼‰
   - æ”¯æŒä¸å…¶ä»–Unixå·¥å…·é›†æˆï¼ˆjqã€grepã€awkã€sedï¼‰
   - æ”¯æŒCI/CDæµæ°´çº¿é›†æˆ

4. **æ€§èƒ½ä¼˜ç§€** â­â­â­â­
   - Repositoryä¼˜å…ˆï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
   - æ··åˆæ£€ç´¢ï¼Œå…¼é¡¾æ—¶é—´å’Œè¯­ä¹‰
   - è½»é‡çº§ç¼–æ’ï¼Œé¿å…è¿‡åº¦è®¾è®¡

5. **å®‰å…¨å¯é ** â­â­â­â­
   - A-MemGuardé›†æˆï¼Œä¸»åŠ¨é˜²å¾¡
   - å…±è¯†éªŒè¯ï¼Œé˜²æ­¢é”™è¯¯ä¼ æ’­
   - åŒè®°å¿†ç»“æ„ï¼Œéš”ç¦»å¤±è´¥

---

**è´Ÿè´£äºº**: AI Assistant  
**å®¡æ ¸**: å¾…ç”¨æˆ·ç¡®è®¤  
**é¢„è®¡å®Œæˆ**: åˆ†é˜¶æ®µå®æ–½ï¼ˆP0ä»Šå¤©ï¼ŒP1ä¸‹å‘¨ï¼ŒP2ä¸‹æœˆï¼‰  
**å‚è€ƒæ–‡æ¡£**: 
- `FINAL_ARCHITECTURE_DECISION.md` - å½“å‰æ¶æ„å†³ç­–
- `CODE_ANALYSIS_DATA_FLOW.md` - ä»£ç è¿½è¸ªåˆ†æ
- `contextfs.md` - ContextFSè®ºæ–‡åˆ†æ
- `agentx4.md` - å®Œæ•´æ”¹é€ è®¡åˆ’
