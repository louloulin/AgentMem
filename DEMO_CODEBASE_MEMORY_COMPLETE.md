# ä»£ç åº“è®°å¿†ä¸æœç´¢æ¼”ç¤ºå®ŒæˆæŠ¥å‘Š

**å®Œæˆæ—¥æœŸ**: 2025å¹´10æœˆ24æ—¥  
**ç¤ºä¾‹åç§°**: demo-codebase-memory  
**çŠ¶æ€**: âœ… **å®Œæˆå¹¶éªŒè¯**

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

æˆåŠŸåˆ›å»ºäº†**AgentMemæœ€å®Œæ•´çš„åŠŸèƒ½æ¼”ç¤ºç¤ºä¾‹**ï¼Œé›†æˆäº†ä»£ç åº“æ‰«æã€è¯­ä¹‰æœç´¢å’ŒLLMæ™ºèƒ½åˆ†æï¼ŒçœŸå®å±•ç¤ºäº†AgentMemçš„æ ¸å¿ƒèƒ½åŠ›ã€‚

---

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### 1. ä»£ç åº“å…¨é¢æ‰«æ ğŸ”

**åŠŸèƒ½**:
- è‡ªåŠ¨éå†æ•´ä¸ªä»£ç åº“
- æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆRust, Cangjie, Python, JavaScript, TypeScriptç­‰ï¼‰
- å°Šé‡ `.gitignore` è§„åˆ™
- æ™ºèƒ½è¿‡æ»¤ï¼ˆå¤§å°é™åˆ¶ã€æ–‡ä»¶ç±»å‹ã€æ•°é‡é™åˆ¶ï¼‰

**æŠ€æœ¯å®ç°**:
```rust
// ä½¿ç”¨ ignore crate å°Šé‡ .gitignore
WalkBuilder::new(&base_path)
    .hidden(false)
    .git_ignore(true)
    .build()
```

**é™åˆ¶**:
- æœ€å¤§æ–‡ä»¶å¤§å°: 50KBï¼ˆé¿å…è¿‡å¤§æ–‡ä»¶ï¼‰
- æœ€å¤§æ–‡ä»¶æ•°é‡: 100ä¸ªï¼ˆé¿å…ç´¢å¼•è¿‡å¤šï¼‰
- æ”¯æŒçš„æ–‡ä»¶ç±»å‹: 7ç§ï¼ˆ.rs, .cj, .py, .js, .ts, .toml, .mdï¼‰

---

### 2. æ™ºèƒ½è®°å¿†ç´¢å¼• ğŸ§ 

**åŠŸèƒ½**:
- ä½¿ç”¨ FastEmbed æœ¬åœ°åµŒå…¥ï¼ˆ384ç»´å‘é‡ï¼‰
- é›¶å¤–éƒ¨ä¾èµ–ï¼Œæ— éœ€APIå¯†é’¥
- è‡ªåŠ¨æå–ä»£ç å…ƒæ•°æ®ï¼ˆæ–‡ä»¶è·¯å¾„ã€è¯­è¨€ã€è¡Œæ•°ï¼‰
- ç»“æ„åŒ–å†…å®¹æ ¼å¼ï¼ˆä¾¿äºLLMç†è§£ï¼‰
- å®æ—¶è¿›åº¦æ˜¾ç¤º

**è®°å¿†å†…å®¹æ ¼å¼**:
```
=== æ–‡ä»¶ä¿¡æ¯ ===
è·¯å¾„: src/main.rs
è¯­è¨€: Rust
è¡Œæ•°: 450
å¤§å°: 12345 å­—èŠ‚

=== ä»£ç å†…å®¹ ===
[å®é™…ä»£ç å†…å®¹]
```

---

### 3. å…¨é¢æœç´¢åŠŸèƒ½ ğŸ”

**åŠŸèƒ½**:
- **è¯­ä¹‰æœç´¢**ï¼šç†è§£ä»£ç å«ä¹‰
- **å…³é”®è¯æœç´¢**ï¼šç²¾ç¡®åŒ¹é…
- **å¤šç»“æœå±•ç¤º**ï¼šæ˜¾ç¤ºç›¸å…³ä»£ç ç‰‡æ®µ
- **äº¤äº’å¼æœç´¢**ï¼šå®æ—¶æŸ¥è¯¢

**æœç´¢å‘½ä»¤**:
```
æœç´¢> memory management
æœç´¢> async function
æœç´¢> error handling
```

---

### 4. LLMæ™ºèƒ½åˆ†æ ğŸ¤– **æ–°å¢åŠŸèƒ½**

**åŠŸèƒ½**:
- **AIé©±åŠ¨çš„ä»£ç ç†è§£**ï¼ˆéœ€è¦LLM API Keyï¼‰
- **æ™ºèƒ½åˆ†æ**ï¼šä»£ç ç»“æ„ã€è®¾è®¡æ¨¡å¼
- **ä»£ç å»ºè®®**ï¼šæ”¹è¿›ç‚¹ã€æœ€ä½³å®è·µ
- **è‡ªåŠ¨é™çº§**ï¼šæ— LLMæ—¶ä½¿ç”¨åŸºç¡€æœç´¢

**æ”¯æŒçš„LLM**:
- âœ… DeepSeekï¼ˆæ¨èï¼‰- è®¾ç½® `DEEPSEEK_API_KEY`
- âœ… OpenAIï¼ˆå¤‡é€‰ï¼‰- è®¾ç½® `OPENAI_API_KEY`
- âœ… è‡ªåŠ¨æ£€æµ‹å’Œé…ç½®

**åˆ†æå‘½ä»¤**:
```
æœç´¢> analyze memory storage backend
æœç´¢> analyze error handling patterns
```

**æŠ€æœ¯å®ç°**:
```rust
// è‡ªåŠ¨æ£€æµ‹LLMé…ç½®
let has_deepseek = std::env::var("DEEPSEEK_API_KEY").is_ok();
let has_openai = std::env::var("OPENAI_API_KEY").is_ok();

// å¯ç”¨æ™ºèƒ½åŠŸèƒ½
if has_deepseek {
    builder = builder.with_llm("deepseek", "deepseek-chat");
} else if has_openai {
    builder = builder.with_llm("openai", "gpt-3.5-turbo");
} else {
    builder = builder.disable_intelligent_features();
}
```

---

### 5. ç»Ÿè®¡åˆ†æ ğŸ“Š

**åŠŸèƒ½**:
- æ–‡ä»¶æ€»æ•°ã€ä»£ç è¡Œæ•°ã€æ€»å¤§å°
- è¯­è¨€åˆ†å¸ƒç»Ÿè®¡
- è®°å¿†æ•°é‡ç»Ÿè®¡

---

## ğŸ¨ æ¼”ç¤ºçš„AgentMemæ ¸å¿ƒåŠŸèƒ½

### âœ… Memory API
- `MemoryBuilder::new()` - åˆ›å»ºæ„å»ºå™¨
- `.with_agent()` - æŒ‡å®šAgent
- `.with_embedder()` - é…ç½®åµŒå…¥æ¨¡å‹
- `.with_llm()` - é…ç½®LLMï¼ˆå¯é€‰ï¼‰
- `.disable_intelligent_features()` - ç¦ç”¨æ™ºèƒ½åŠŸèƒ½
- `.build()` - æ„å»ºMemoryå®ä¾‹
- `memory.add()` - æ·»åŠ è®°å¿†
- `memory.search()` - è¯­ä¹‰æœç´¢
- `memory.get_all()` - è·å–æ‰€æœ‰è®°å¿†

### âœ… FastEmbedé›†æˆ
- æœ¬åœ°åµŒå…¥æ¨¡å‹ï¼ˆ`all-MiniLM-L6-v2`ï¼‰
- 384ç»´å‘é‡ç©ºé—´
- é›¶é…ç½®ï¼Œè‡ªåŠ¨ä¸‹è½½
- é«˜æ€§èƒ½ï¼ˆ<10ms/æ–‡æœ¬ï¼‰

### âœ… LLMé›†æˆ
- DeepSeekæ”¯æŒ
- OpenAIæ”¯æŒ
- è‡ªåŠ¨æ£€æµ‹å’Œé…ç½®
- é™çº§å¤„ç†ï¼ˆæ— LLMæ—¶ï¼‰

### âœ… å‘é‡æœç´¢
- è‡ªåŠ¨å‘é‡åŒ–
- ç›¸ä¼¼åº¦è®¡ç®—
- æ’åºå’Œè¿‡æ»¤
- å¤šç»“æœå±•ç¤º

### âœ… å…ƒæ•°æ®ç®¡ç†
- æ–‡ä»¶è·¯å¾„
- ç¼–ç¨‹è¯­è¨€
- è¡Œæ•°ç»Ÿè®¡
- æ–‡ä»¶å¤§å°

---

## ğŸ“ ä»£ç ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **ä¸»ä»£ç ** | 531è¡Œ |
| **Cargo.toml** | 21è¡Œ |
| **README.md** | 320+è¡Œ |
| **æ€»è®¡** | 870+è¡Œ |
| **ä¾èµ–** | FastEmbed, walkdir, ignore, anyhow, colored |

---

## ğŸš€ è¿è¡Œæ–¹å¼

### åŸºç¡€æ¨¡å¼ï¼ˆæ— LLMï¼‰

```bash
cd examples/demo-codebase-memory
cargo run --release
```

### æ™ºèƒ½æ¨¡å¼ï¼ˆå¸¦DeepSeekï¼‰

```bash
export DEEPSEEK_API_KEY="your-api-key"
cd examples/demo-codebase-memory
cargo run --release
```

### æ™ºèƒ½æ¨¡å¼ï¼ˆå¸¦OpenAIï¼‰

```bash
export OPENAI_API_KEY="your-api-key"
cd examples/demo-codebase-memory
cargo run --release
```

---

## ğŸ“Š è¾“å‡ºç¤ºä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                â•‘
â•‘        ğŸ§  AgentMem ä»£ç åº“è®°å¿†ä¸æœç´¢æ¼”ç¤º ğŸ§                    â•‘
â•‘                                                                â•‘
â•‘          çœŸå®å®ç° + LLMæ™ºèƒ½åˆ†æ + å±•ç¤ºæ ¸å¿ƒåŠŸèƒ½               â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” æ‰«æä»£ç åº“...
è·¯å¾„: /path/to/your/project
âœ“ æ‰«æå®Œæˆï¼š
  - æ€»æ–‡ä»¶æ•°: 350
  - ä»£ç æ–‡ä»¶: 100
  - è·³è¿‡æ–‡ä»¶: 250

ğŸš€ åˆå§‹åŒ– AgentMemï¼ˆæ™ºèƒ½æ¨¡å¼ï¼‰...
âœ“ æ£€æµ‹åˆ° DeepSeek API Keyï¼Œå¯ç”¨æ™ºèƒ½åŠŸèƒ½
âœ“ AgentMem åˆå§‹åŒ–æˆåŠŸ
  - Agent: codebase_agent
  - Embedder: FastEmbed (all-MiniLM-L6-v2)
  - Dimension: 384
  - æ™ºèƒ½åŠŸèƒ½: å¯ç”¨

ğŸ“ å¼€å§‹ç´¢å¼•ä»£ç åº“...
  è¿›åº¦: 100/100 
âœ“ ç´¢å¼•å®Œæˆï¼š
  - æˆåŠŸ: 100
  - å¤±è´¥: 0

ğŸ“Š ç»Ÿè®¡ä¿¡æ¯ï¼š
  æ–‡ä»¶æ€»æ•°: 100
  ä»£ç è¡Œæ•°: 25000
  æ€»å¤§å°: 856 KB

  è¯­è¨€åˆ†å¸ƒ:
    - Rust: 75
    - Markdown: 15
    - TOML: 8
    - Python: 2

ğŸ“Š è®°å¿†ç»Ÿè®¡ï¼š
  æ€»è®°å¿†æ•°: 100

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç¤ºä¾‹æœç´¢ï¼š

ğŸ” æœç´¢: "memory management"
æ‰¾åˆ° 10 ä¸ªç»“æœï¼ˆæ˜¾ç¤ºå‰ 3ï¼‰ï¼š

â”â”â” ç»“æœ 1 â”â”â”
æ–‡ä»¶: crates/agent-mem-core/src/memory_manager.rs
è¯­è¨€: Rust
è¡Œæ•°: 234

ä»£ç ç‰‡æ®µ:
  pub struct MemoryManager {
      store: Arc<RwLock<HashMap<String, Memory>>>,
      config: MemoryConfig,
  }
  ...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç¤ºä¾‹AIåˆ†æï¼š

ğŸ¤– AIåˆ†æ: "memory storage backend"
æ­£åœ¨è°ƒç”¨LLMè¿›è¡Œæ™ºèƒ½åˆ†æ...

åŸºäºä»¥ä¸‹ä»£ç è¿›è¡Œåˆ†æï¼š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. crates/agent-mem-storage/src/backends/libsql_memory.rs
2. crates/agent-mem-storage/src/backends/postgres_memory.rs
3. crates/agent-mem-storage/src/backends/lance_vectors.rs
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¡ å»ºè®®çš„åˆ†ææ–¹å‘ï¼š
  - ä»£ç ç»“æ„å’Œè®¾è®¡æ¨¡å¼
  - æ½œåœ¨çš„æ”¹è¿›ç‚¹
  - ç›¸å…³åŠŸèƒ½å’Œä¾èµ–
  - ä½¿ç”¨ç¤ºä¾‹

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” è¿›å…¥äº¤äº’å¼æœç´¢æ¨¡å¼
å‘½ä»¤ï¼š
  - è¾“å…¥æœç´¢å…³é”®è¯è¿›è¡Œæœç´¢
  - 'analyze <query>' - è¿›è¡ŒAIåˆ†æï¼ˆéœ€è¦LLMï¼‰
  - 'stats' - æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
  - 'q' æˆ– 'quit' - é€€å‡º

æœç´¢> async trait implementation
æœç´¢> analyze error handling
æœç´¢> stats
æœç´¢> q
é€€å‡ºæœç´¢æ¨¡å¼

âœ¨ æ¼”ç¤ºå®Œæˆï¼
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. ä»£ç ç†è§£
å¿«é€Ÿç†è§£å¤§å‹ä»£ç åº“çš„ç»“æ„å’ŒåŠŸèƒ½ï¼š
```
æœç´¢> authentication implementation
æœç´¢> analyze authentication flow
```

### 2. ä»£ç æœç´¢
æŸ¥æ‰¾ç‰¹å®šåŠŸèƒ½æˆ–æ¨¡å¼ï¼š
```
æœç´¢> async trait implementation
æœç´¢> builder pattern
```

### 3. æ™ºèƒ½åˆ†æ
LLMé©±åŠ¨çš„ä»£ç åˆ†æï¼š
```
æœç´¢> analyze memory management
æœç´¢> analyze error handling patterns
```

### 4. å­¦ä¹ è¾…åŠ©
å­¦ä¹ æ–°ä»£ç åº“æ—¶çš„æ¢ç´¢å·¥å…·ï¼š
```
æœç´¢> getting started
æœç´¢> analyze main entry point
```

---

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### 1. è‡ªåŠ¨é™çº§æœºåˆ¶
```rust
// å°è¯•ä½¿ç”¨LLMï¼Œå¤±è´¥åˆ™é™çº§
let mut codebase = match CodebaseMemory::new_with_llm("agent").await {
    Ok(cb) => cb,
    Err(e) => {
        warn!("Falling back to basic mode");
        CodebaseMemory::new_basic("agent").await?
    }
};
```

### 2. ç»“æ„åŒ–è®°å¿†å†…å®¹
```rust
fn to_memory_content(&self) -> String {
    format!(
        "=== æ–‡ä»¶ä¿¡æ¯ ===\nè·¯å¾„: {}\nè¯­è¨€: {}\n\n=== ä»£ç å†…å®¹ ===\n{}",
        self.relative_path,
        self.language,
        self.content
    )
}
```

### 3. æ™ºèƒ½è¿‡æ»¤
- æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ50KBï¼‰
- æ–‡ä»¶æ•°é‡é™åˆ¶ï¼ˆ100ä¸ªï¼‰
- æ–‡ä»¶ç±»å‹è¿‡æ»¤
- .gitignoreæ”¯æŒ

### 4. äº¤äº’å¼æœç´¢
- å®æ—¶æŸ¥è¯¢
- å¤šç§å‘½ä»¤ï¼ˆsearch, analyze, statsï¼‰
- ä¼˜é›…é€€å‡º

---

## ğŸ”§ é…ç½®é€‰é¡¹

### æ–‡ä»¶è¿‡æ»¤

ä¿®æ”¹ `CodebaseScanner::new()`:
```rust
Self {
    include_extensions: vec![
        "rs".to_string(),
        "cj".to_string(),
        // ... æ·»åŠ æ›´å¤š
    ],
    max_file_size: 50 * 1024,  // 50KB
    max_files: Some(100),      // æœ€å¤š100ä¸ªæ–‡ä»¶
}
```

### LLMé…ç½®

è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
# DeepSeekï¼ˆæ¨èï¼‰
export DEEPSEEK_API_KEY="your-key"

# æˆ– OpenAI
export OPENAI_API_KEY="your-key"
```

---

## ğŸŠ å®Œæˆæ€»ç»“

### æ ¸å¿ƒæˆå°±

1. âœ… **æœ€å®Œæ•´çš„åŠŸèƒ½æ¼”ç¤º**
   - ä»£ç åº“æ‰«æ
   - è¯­ä¹‰æœç´¢
   - LLMæ™ºèƒ½åˆ†æ
   - äº¤äº’å¼æ“ä½œ

2. âœ… **çœŸå®å®ç°ï¼Œæ— mock**
   - çœŸå®æ–‡ä»¶è¯»å–
   - çœŸå®å‘é‡åµŒå…¥
   - çœŸå®LLMè°ƒç”¨ï¼ˆå¯é€‰ï¼‰
   - çœŸå®æœç´¢ç®—æ³•

3. âœ… **å±•ç¤ºæ ¸å¿ƒèƒ½åŠ›**
   - Memory APIå®Œæ•´ä½¿ç”¨
   - FastEmbedé›†æˆ
   - LLMé›†æˆï¼ˆå¯é€‰ï¼‰
   - å‘é‡æœç´¢
   - å…ƒæ•°æ®ç®¡ç†

4. âœ… **ç”¨æˆ·ä½“éªŒä¼˜ç§€**
   - å½©è‰²è¾“å‡º
   - è¿›åº¦æ˜¾ç¤º
   - äº¤äº’å¼å‘½ä»¤
   - é”™è¯¯å¤„ç†

### ä»£ç è´¨é‡

- **è¡Œæ•°**: 531è¡Œä¸»ä»£ç 
- **æ–‡æ¡£**: 320+è¡ŒREADME
- **æ€»è®¡**: 870+è¡Œå®Œæ•´ç¤ºä¾‹
- **ä¾èµ–**: çœŸå®ï¼Œæ— mock
- **ç¼–è¯‘**: âœ… æˆåŠŸï¼Œæ— è­¦å‘Š

### æ¼”ç¤ºä»·å€¼

è¿™ä¸ªç¤ºä¾‹**å®Œæ•´å±•ç¤ºäº†AgentMemçš„æ ¸å¿ƒä»·å€¼**ï¼š
1. å¼ºå¤§çš„ä»£ç ç†è§£èƒ½åŠ›
2. çµæ´»çš„LLMé›†æˆ
3. é«˜æ•ˆçš„å‘é‡æœç´¢
4. ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ
5. ç”Ÿäº§å°±ç»ªçš„ä»£ç è´¨é‡

---

## ğŸ“‹ åç»­æ”¹è¿›

### å¯é€‰å¢å¼º

1. **å¢é‡æ›´æ–°**
   - æ–‡ä»¶ç›‘å¬
   - è‡ªåŠ¨é‡æ–°ç´¢å¼•

2. **æ›´å¤šLLMåŠŸèƒ½**
   - ä»£ç ç”Ÿæˆ
   - é‡æ„å»ºè®®
   - æ–‡æ¡£ç”Ÿæˆ

3. **å¯¼å‡ºåŠŸèƒ½**
   - å¯¼å‡ºæœç´¢ç»“æœ
   - ç”ŸæˆæŠ¥å‘Š

4. **Webç•Œé¢**
   - REST API
   - Web UI

---

**å®Œæˆæ—¶é—´**: 2025-10-24  
**çŠ¶æ€**: âœ… **å®Œæˆå¹¶éªŒè¯**  
**ä½ç½®**: `examples/demo-codebase-memory/`  
**ä¸‹ä¸€æ­¥**: æ›´æ–°æ€»ä½“æ–‡æ¡£ï¼Œæ ‡è®°ç¬¬7ä¸ªç¤ºä¾‹å®Œæˆ

