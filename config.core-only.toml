# AgentMem 核心功能配置
# 此配置仅启用核心功能（CRUD + 向量搜索），无需 LLM API Key
#
# 使用方法:
#   1. 复制此文件: cp config.core-only.toml config.toml
#   2. (可选) 自定义配置项
#   3. 启动服务: just dev
#
# 核心功能可用:
#   ✅ 添加记忆
#   ✅ 向量搜索
#   ✅ 批量操作
#   ✅ 记忆管理
#
# 智能功能未启用:
#   ❌ 事实提取（需要 LLM）
#   ❌ 智能排序（需要 LLM）
#   ❌ 自动分类（需要 LLM）

# ============================================================================
# 服务器配置
# ============================================================================
[server]
# 服务器监听地址
host = "127.0.0.1"

# 服务器端口
port = 8080

# 工作线程数（0 = 自动检测，通常等于 CPU 核心数）
workers = 0

# ============================================================================
# 数据库配置
# ============================================================================
[database]
# 数据库后端类型
# 可选值: "libsql" (SQLite), "postgres"
# 默认: "libsql" (无需安装，文件数据库)
backend = "libsql"

# LibSQL 数据库文件路径
# 使用 "file://" 前缀表示文件路径
# 使用 ":memory:" 表示内存数据库（测试用）
url = "file:./data/agentmem.db"

# 自动运行数据库迁移
auto_migrate = true

# 连接池配置
[database.pool]
# 最大连接数
max_connections = 10

# 最小空闲连接数
min_idle = 2

# 连接超时（秒）
connection_timeout = 30

# ============================================================================
# 向量嵌入配置
# ============================================================================
[embeddings]
# 嵌入模型提供商
# 可选值: "fastembed" (本地, 推荐), "openai" (需要 API Key)
provider = "fastembed"

# 模型名称
# FastEmbed 模型: "BAAI/bge-small-en-v1.5" (推荐), "BAAI/bge-base-en-v1.5"
# OpenAI 模型: "text-embedding-3-small", "text-embedding-ada-002"
model = "BAAI/bge-small-en-v1.5"

# 嵌入维度（自动检测，通常无需设置）
# dimension = 384

# 批处理大小（一次处理多少文本）
batch_size = 32

# ============================================================================
# 向量存储配置
# ============================================================================
[vector_store]
# 向量数据库类型
# 可选值: "lancedb" (本地文件), "qdrant" (需要服务)
type = "lancedb"

# LanceDB 向量存储路径
# 使用 "lancedb://" 前缀
url = "lancedb://./data/vectors.lance"

# 向量索引类型
# 可选值: "flat" (精确搜索), "ivf" (近似搜索，更快)
index_type = "flat"

# ============================================================================
# LLM 配置 (已禁用 - 核心功能模式)
# ============================================================================
[llm]
# ❌ 禁用 LLM（核心功能不需要）
enable = false

# 如需启用智能功能，请设置:
# enable = true
# provider = "openai" | "zhipu" | "anthropic"
# api_key = "your-api-key-here"
# model = "gpt-4" | "glm-4" | "claude-3-opus"

# ============================================================================
# 认证配置 (开发模式)
# ============================================================================
[auth]
# ❌ 开发模式禁用认证（仅用于本地开发）
enable = false

# JWT 密钥（生产环境必须设置 >= 32 字节）
# jwt_secret = "your-secret-key-at-least-32-bytes-long"

# Token 过期时间（小时）
# token_expiration = 24

# ============================================================================
# 缓存配置
# ============================================================================
[cache]
# 启用 L1 内存缓存
enable_l1 = true

# L1 缓存最大条目数
l1_max_size = 1000

# L1 缓存 TTL（秒）
l1_ttl = 3600

# 启用 L2 Redis 缓存（可选）
# enable_l2 = false
# l2_url = "redis://localhost:6379"

# ============================================================================
# 日志配置
# ============================================================================
[logging]
# 日志级别
# 可选值: "trace", "debug", "info", "warn", "error"
level = "info"

# 日志格式
# 可选值: "pretty" (开发), "json" (生产)
format = "pretty"

# 日志文件路径（可选，不设置则输出到控制台）
# file = "./logs/agentmem.log"

# ============================================================================
# 性能配置
# ============================================================================
[performance]
# 查询结果限制（防止返回过多结果）
default_limit = 10
max_limit = 100

# 批量操作大小限制
max_batch_size = 100

# 请求超时（秒）
request_timeout = 30

# 并发查询数
max_concurrent_queries = 10

# ============================================================================
# CORS 配置（开发模式）
# ============================================================================
[cors]
# 允许的源（开发模式允许所有源）
allow_origins = ["http://localhost:3000", "http://localhost:3001"]

# 允许的 HTTP 方法
allow_methods = ["GET", "POST", "PUT", "DELETE", "OPTIONS"]

# 允许的请求头
allow_headers = ["Content-Type", "Authorization", "X-User-ID", "X-Organization-ID"]

# 允许携带凭证
allow_credentials = true

# ============================================================================
# 速率限制配置（开发模式宽松）
# ============================================================================
[rate_limit]
# 每秒请求数
requests_per_second = 100

# 突发请求数
burst_size = 200

# ============================================================================
# 监控配置
# ============================================================================
[monitoring]
# 启用 Prometheus 指标
enable_metrics = true

# 指标端点路径
metrics_path = "/metrics"

# 启用健康检查端点
enable_health_check = true

# 健康检查端点路径
health_check_path = "/health"

# ============================================================================
# 插件配置
# ============================================================================
[plugins]
# 启用插件系统
enable = false

# 插件目录（可选）
# plugin_dir = "./plugins"

# 自动加载插件
# auto_load = []
